# Disk Encryption

On select models of FMADIO capture systems full disk encryption is available. When available it uses the SSD drivers controller firmware to provide AES256 encryption with the OPAL interface standard.\
\
States of the system is as follows\
\
**Power Off:**\
All data is encrypted accessing requires a password\
\
**First Power On:**\
Drives are accessible but data remains encrypted\
\
**First Power On Unlock:**\
Each drive in the system is unlocked by a shared password. This allows the drives media to be written/read from\
\
**Warm Reboot:**\
After Unlock the drives remain unlocked\
\
**Power Off:**\
On power loss to the disks, all data becomes un-accessible and fully encrypted\
\
\
Data is encrypted using AESS256 and a random key generated by the SSD Controller. The Password specified encrypts/decrypts this AES256 key allowing the controller to read/write from the media. This encryption key is only kept in volatile RAM, thus when power to the drive is removed, the encryption key is lost. Once the encryption key is gone all data on the storage media can not be read.\
\
Drives can never be "bricked" as the drives can be reset by creating a new AES256 key. This reset however will remove all data previously written to the drive.\
\


**DRIVE ENCRYPTION STATUS**

```
sudo disk_lock.lua --status 
```

This Operation displays the drive encryption state, example as follows

```

fmadio@fmadio80v1-095:~$ sudo disk_lock.lua --status
[scr0    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd0    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd1    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd2    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd3    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd4    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd5    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd6    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd7    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd8    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd9    ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd10   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd11   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd12   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd13   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd14   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd15   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd16   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd17   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd18   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd19   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd20   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd21   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd22   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd23   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd24   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd25   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd26   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd27   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd28   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd29   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd30   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd31   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd32   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd33   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd34   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd35   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd36   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd37   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd38   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd39   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd40   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd41   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd42   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd43   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd44   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
[ssd45   ] EncSupport:true EncEnabled:true EncSecurity:true DiskLocked:false MasterPWRev:2
fmadio@fmadio80v1-095:~$
```

Explanation of each field is as follows:\
\
**EncSupport**: Shows if the drive supports full disk encryption\
\
**EncEnabled**: Shows true/false if encryption is enabled on this drive\
\
**EncSecurity**: Shows true/false if high security mode is enabled. This should always be TRUE otherwise the default master password can unlock the drive\
\
**DiskLocked**: Shows true/false if the drives is currently locked or unlocked\
\
**MasterPWRev**: Shows number of times the master (not user) password has been changed\
\


**RESETTING PASSWORD / FORMAT WIPE**

```
sudo disk_lock.lua --reset 
```

This sets a new encryption password on all the disks. It will also WIPE ALL DATA ON THE CURRENT DISK. Please ensure there is no critical data on the system before running this command. After the operation the disks are in an UNLOCKED state.\
\


**UNLOCKING DISKS**

```
sudo disk_lock.lua --unlock 
```

Command will unlock and verify correct functionality of the disks. Starts by unlocking each disk using the supplied password, then reloading all storage components of the FMADIO system which reference the disks. Once complete it then runs a self verification test by writing a randomly seeded increasing sequence number to a small section of the storage reserved for verification (4GB or so) then reads back and verifies the sequence numbers match what was written. If the unlock was successful, an ALL PASS message is displayed. Any errors encountered will show a red failure message.\
\


**INDEX UTILITY**

```
sudo disk_lock.lua --index 
```

Helper utility that creates a RAID0 partition on /mnt/store1 such that the capture file index can reside there (instead of on the OS disk). Typically after this command is ran, an array format is issued to complete the process.
